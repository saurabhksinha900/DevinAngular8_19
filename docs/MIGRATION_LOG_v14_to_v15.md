# Migration Log: Angular 14 → 15

## Before / After

| Package | Before | After |
|---------|--------|-------|
| Angular | 14.3.0 | 15.2.10 |
| Angular CLI | 14.2.13 | 15.2.11 |
| TypeScript | 4.7.4 | 4.9.5 |
| RxJS | 7.5.7 | 7.8.1 |
| zone.js | 0.11.8 | 0.13.3 |
| tslib | 2.3.1 | 2.5.3 |
| Node | 14.21.3 | 14.21.3 |

## Node Version

Node 14.21.3 retained for this hop. Angular 15 officially supports Node 14.20+, 16.13+, and 18.10+. Node 14 still works at this version.

## Key Changes

1. **Webpack 5 test discovery**: Angular 15 uses webpack 5 for Karma tests. The old `require.context()` pattern in `test.ts` no longer works. Removed the `require.context` call and added `include: ["src/**/*.spec.ts"]` to angular.json test options so the Angular CLI discovers spec files automatically.
2. **zone.js import path**: Updated `import 'zone.js/dist/zone-testing'` → `import 'zone.js/testing'` in `test.ts` (the `/dist/` sub-path was removed in zone.js 0.12+).
3. **ajv dependency conflict**: `ajv-keywords@5.1.0` requires `ajv@^8.8.2` but the hoisted tree had `ajv@6`. Resolved by installing `ajv@8.12.0`, `ajv-keywords@5.1.0`, `schema-utils@4.0.0`, and `webpack-dev-server@4.11.1` as dev dependencies.
4. **RxJS minor bump**: 7.5.7 → 7.8.1 (no breaking changes).

## Deprecations Found → Replacements

| Deprecated | Replacement | Rationale |
|-----------|-------------|-----------|
| `@angular/compiler-cli` `enableI18nLegacyMessageIdFormat` | Removed (defaults off) | Legacy i18n IDs no longer generated by default |
| `require.context()` in test.ts | `include` array in angular.json test config | Webpack 5 drops CommonJS `require.context` in favour of build-tool-driven discovery |
| `zone.js/dist/*` import paths | `zone.js/*` (no `/dist/`) | `/dist/` sub-paths removed in zone.js 0.12+ |

## Test Results

- **Unit tests**: 62 / 62 PASSED (added 1 new edge test)
- **Edge test added**: `should handle HTTP 429 rate-limit response (edge test – hop v14→v15)` in api.service.spec.ts
- **Coverage**: Not configured (same as prior hops)

## Build Notes

- Production build (AOT): **SUCCESS**
- Initial bundle: ~267 kB (estimated transfer ~74 kB)
- Lazy chunks present for all 6 feature modules
- Warnings: unused service files flagged (cosmetic, carried from baseline)

## Assumptions

1. Node 14.21.3 retained since Angular 15 still supports it (>=14.20). Will upgrade to Node 16+ for Angular 16 hop.
2. `ajv`/`schema-utils`/`webpack-dev-server` pinned as dev deps to resolve transitive dependency conflict — standard practice for webpack 5 migration.
3. `@angular/platform-browser-dynamic` kept as-is; no standalone components migration attempted (optional in v15).
